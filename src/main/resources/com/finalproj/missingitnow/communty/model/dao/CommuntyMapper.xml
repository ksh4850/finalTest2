<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.finalproj.missingitnow.communty.model.dao.CommuntyMapper">
 
 	
 	<insert id="insertCommuntyRegist" parameterType="SPostDTO">
 		INSERT
 		  INTO TBL_POST A
 		  (
 		  	A.POST_NO
		  , A.USER_NO
		  , A.POST_DETAILS
		  ,	A.POST_DATE
		  ,	A.POST_STATUS
		  , A.POST_HITS
		  ,	A.POST_LIKES
		  ,	A.POST_HOUSING_TYPE
		  ,	A.POST_ACREAGE
		  ,	A.POST_RESIDENCE_TYPE
		  ,	A.POST_COST_TYPE
 		  )
 		  VALUES
 		  (
 		  	'POST' || LPAD(SEQ_POST.NEXTVAL,4,0)
 		  , #{user.userNo}
 		  , #{postDetail}
 		  , #{postDate}
 		  , DEFAULT
 		  , DEFAULT
 		  , DEFAULT
 		  , #{housingType}
 		  , #{acreage}
 		  , #{residenceType}
 		  , #{cost}
 		  )
 		 	
 	
 	</insert>
 	
 	<insert id="insertPostImg" parameterType="SPostImgDTO" >
 	
 		 <selectKey keyProperty="postNo" order="BEFORE" resultType="String">
    		SELECT
    			 'POST' || LPAD(SEQ_POST.CURRVAL,4,0)
    		FROM DUAL
    	</selectKey> 
    		
    	   INSERT
 		    INTO TBL_POST_IMG 
 		  (
 		  	POST_IMG_NO
		  ,	POST_NO
		  ,	P_IMG_ORIGIN_NAME
		  ,	P_IMG_RENAME
		  ,	P_IMG_THN_NAME
		  ,	P_IMG_PATH
 		  )
 		  VALUES
 		  (
 		  	'POSI'||LPAD(SEQ_POST_IMG.NEXTVAL , 4 , 0)
 		  , #{postNo}
		  , #{originName} 
		  , #{reName} 
		  , #{thnbName}
		  , #{path} 
 		  )
 		  
 		 <!--   SELECT
                   'POSI'||LPAD(SEQ_POST_IMG.NEXTVAL , 4 , 0) as imgNo
 		  		   , A.*
 		  	FROM 
 		  	( 
 		  	<foreach collection="list" item="item" index="index" separator="UNION ALL" >
 		  	SELECT
 		  	
 		  		  'POST0001' AS postNo
				, ${item.originName} AS originName 
				, ${item.reName} AS reNameA
				, ${item.thnbName} AS thnbName 
				, ${item.path} AS imgPath
				 
				FROM DUAL </foreach> ) A 
 	 -->
 	</insert>
 	
 	
 	
 	
 
 </mapper>